<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UdaanBase ‚Äî Home Design Cost Calculator</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#ff6b6b; --muted:#98a0b3; --glass: rgba(255,255,255,0.06); /* Stronger glass */
      --glass-2: rgba(255,255,255,0.03);
      --glass-3: rgba(255,255,255,0.08); /* Stronger glass for steps */
      --radius:16px; /* Slightly larger radius for a modern feel */
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    /* Add a global transition to feel smoother */
    *:not(.price-anim){ transition: background-color .3s, border-color .3s, box-shadow .3s, transform .3s, opacity .3s; }
    
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071029 0%, #071529 50%, #03121a 100%);color:#e6eef8}
    
    /* Dynamic Entrance Animation Setup */
    .container{
      max-width:1100px;
      margin:36px auto;
      padding:28px;
      opacity: 0; /* Start hidden */
      transform: translateY(30px); /* Start slightly low */
      /* Slower transition for the main content entrance */
      transition: opacity 1.2s cubic-bezier(0.25, 1, 0.5, 1), transform 1.2s cubic-bezier(0.25, 1, 0.5, 1);
    }
    .container.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    header{display:flex;align-items:center;gap:18px;margin-bottom:28px}
    .logo{
      width:64px; /* Slightly larger logo */
      height:64px;
      background:transparent;
      border-radius:16px;
      display:grid;
      place-items:center;
      box-shadow:0 8px 35px rgba(0,0,0,0.8); /* Stronger shadow */
      padding: 0;
      overflow: hidden;
    }
    .logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    header h1{font-size:24px;margin:0} /* Larger title */
    header p{margin:0;color:var(--muted);font-size:14px}

    .grid{display:grid;grid-template-columns:1fr 380px;gap:24px} /* Increased gap */

    /* Left panel - Enhanced Layered Look */
    .panel{
      background:linear-gradient(180deg,var(--card), rgba(6,9,15,0.4));
      padding:24px; /* Increased padding */
      border-radius:var(--radius);
      box-shadow:0 12px 40px rgba(2,6,12,0.8); /* Deep shadow */
      border:1px solid rgba(255,255,255,0.08); /* Visible border */
      backdrop-filter: blur(10px); /* Increased blur */
    }
    .panel h2{font-size:20px; margin:0 0 16px 0}
    .inputs{display:grid;grid-template-columns:repeat(2,1fr);gap:16px} /* Increased gap */
    
    /* Input Field - More Dynamic Hover */
    .field{
      background:var(--glass-2);
      padding:14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.04);
    }
    .field:hover{
      transform:translateY(-5px) scale(1.01); /* More lift */
      border-color:rgba(255,255,255,0.1);
      box-shadow:0 15px 40px rgba(2,6,12,0.8);
    }
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    
    /* General input/select styling */
    input[type=number], input[type=text], select{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.1);
      background:rgba(0,0,0,0.2); /* Darker input background */
      color:inherit;
      font-size:15px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
    }

    /* Specific styling for the Offers dropdown for readability */
    #offersSelect {
      color: #071029;
      background-color: #f8f8f8;
    }

    .full{grid-column:1/-1}
    .plans{display:flex;flex-direction:column;gap:10px;margin-top:20px}

    /* Plan Selection - More pronounced hover */
    .plan{
      display:flex;justify-content:space-between;align-items:center;
      padding:14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.06);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      cursor: pointer;
    }
    .plan:hover{
      transform:translateY(-8px) scale(1.015) skewX(0.5deg); /* Added subtle skew */
      box-shadow:0 18px 40px rgba(2,6,12,0.8);
      border-color: var(--accent);
    }
    .plan input{margin-right:12px; transform: scale(1.2)}
    .plan .meta{font-size:13px;color:var(--muted)}
    .price-tag{background:linear-gradient(90deg,var(--accent), #ffb46b);padding:8px 14px;border-radius:12px;color:#071029;font-weight:800;font-size:16px}

    /* Right panel (Summary) - Stronger Glass Look */
    .summary{position:sticky;top:36px}
    .card{
      padding:24px;
      border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), transparent);
      border:1px solid rgba(255,255,255,0.06);
      backdrop-filter: blur(8px);
      box-shadow:0 10px 30px rgba(0,0,0,0.5);
    }
    .big-price{font-size:32px;font-weight:800;margin:10px 0}
    .muted{color:var(--muted);font-size:13px}

    .actions{display:flex;gap:12px;margin-top:20px}
    .btn{flex:1;padding:14px 16px;border-radius:14px;border:0;cursor:pointer;font-weight:700;transition:transform .2s, box-shadow .2s}
    .btn-primary{background:linear-gradient(90deg,var(--accent), #ffb46b);color:#071029}
    .btn-ghost{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.1);color:inherit}
    .btn:hover{transform:translateY(-6px);box-shadow:0 15px 35px rgba(0,0,0,0.8)} /* More lift on buttons */

    /* Steps */
    .steps{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
    .step{
      padding:12px;
      border-radius:12px;
      background:var(--glass-3);
      text-align:center;
      border:1px solid rgba(255,255,255,0.04);
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .step h4{margin:6px 0 0 0;font-size:14px}
    .step p{margin:4px 0 0 0;color:var(--muted);font-size:12px}

    /* Offers */
    .offers{margin-top:16px;display:flex;gap:12px;align-items:center;padding:12px;border-radius:14px;background:rgba(255,107,107,0.05); border:1px solid rgba(255,107,107,0.2)}
    .sale-badge{background:rgba(255,107,107,0.15);padding:8px 12px;border-radius:999px;color:var(--accent);font-weight:700}

    footer{margin-top:24px;color:var(--muted);font-size:13px;text-align:center}

    /* responsive */
    @media(max-width:980px){.grid{grid-template-columns:1fr} .summary{position:relative;top:0}}

    /* small fancy touches */
    .sparkle{position:relative}
    .sparkle:after{content:'';position:absolute;right:-18px;top:-12px;width:14px;height:14px;border-radius:50%;background:radial-gradient(circle, rgba(255,255,255,0.9), rgba(255,255,255,0.1));filter:blur(6px);opacity:.7;transform:scale(.6);animation:twinkle 2.6s linear infinite}
    
    /* FESTIVE ANIMATION CSS */
    #festive-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: -1;
    }

    .light-particle {
      position: absolute;
      bottom: -10px;
      width: 5px; /* Slightly larger particles */
      height: 5px;
      background-color: #ffc25b; /* Brighter golden color */
      border-radius: 50%;
      box-shadow: 0 0 10px 5px rgba(255, 170, 0, 0.9), 0 0 30px 8px rgba(255, 200, 0, 0.4);
      opacity: 0;
      animation: float-up 12s linear infinite, twinkle 3s ease-in-out infinite alternate; /* Slower, smoother float */
    }

    @keyframes float-up {
      0% { transform: translateY(0) translateX(0); opacity: 0; }
      20% { opacity: 0.9; }
      80% { opacity: 0.9; }
      100% { transform: translateY(-100vh) translateX(20px); opacity: 0; } /* Subtle side drift */
    }

    /* Make existing sparkle and particle twinkle look good */
    @keyframes twinkle{
      0%{transform:scale(.6);opacity:.8}
      50%{transform:scale(1.2);opacity:1}
      100%{transform:scale(.6);opacity:.8}
    }

    /* animated price change */
    .price-anim{display:inline-block;transition:transform .35s ease, opacity .25s}
    .price-anim.bounce{transform:translateY(-6px);opacity:0.95}

  </style>
</head>
<body>
  <!-- FESTIVE BACKGROUND ADDED -->
  <div id="festive-bg"></div>
  <!-- END FESTIVE BACKGROUND ADDED -->
  
  <div class="container" id="main-container">
    <header>
      <div class="logo">
        <img 
          src="logo.jpg" 
          alt="Company Logo" 
          onerror="this.onerror=null;this.src='https://placehold.co/64x64/ff6b6b/071029?text=Logo';"
        />
      </div>
      <div>
        <h1>UdaanBase ‚Äî Cost Calculator</h1>
        <p>Beautiful homes within reach ¬∑ Instant estimate for plans, elevations & packages</p>
      </div>
    </header>

    <div class="grid">
      <div class="panel">
        
        <div class="steps" style="margin-bottom: 24px;">
          <div class="step"><div style="font-size:24px">1</div><h4>Enter Dimensions</h4><p>Feet & inches ‚Äî precise area</p></div>
          <div class="step"><div style="font-size:24px">2</div><h4>Select Service¬†</h4><p>Pick Naksha / Elevation / Full</p></div>
          <div class="step"><div style="font-size:24px">3</div><h4>Send Order</h4><p>Share via WhatsApp with details</p></div>
        </div>

        <h2>Enter plot dimensions</h2>
        <div class="inputs">
          <div class="field">
            <label>Length - Feet</label>
            <input id="lengthFeet" type="number" min="0" step="1" value="30" />
          </div>
          <div class="field">
            <label>Length - Inches</label>
            <input id="lengthInch" type="number" min="0" max="11" step="1" value="0" />
          </div>
          <div class="field">
            <label>Width - Feet</label>
            <input id="widthFeet" type="number" min="0" step="1" value="20" />
          </div>
          <div class="field">
            <label>Width - Inches</label>
            <input id="widthInch" type="number" min="0" max="11" step="1" value="0" />
          </div>

          <div class="field full">
            <label>Your Name</label>
            <input id="clientName" type="text" placeholder="e.g. Himanshu Kumar" />
          </div>
          <div class="field full">
            <label>Your Phone (for WhatsApp)</label>
            <input id="clientPhone" type="text" pattern="[+\d\s]{8,}" title="Phone must contain at least 8 digits, plus sign (+), or spaces." placeholder="e.g. +91 70615 70522" />
          </div>
        </div>

        <div class="plans" id="plansList">
          <label style="color:var(--muted);font-size:13px">Choose a service</label>
          <label class="plan"><div><input type="radio" name="plan" value="1" checked /> <strong>Naksha (2D Floor Plan)</strong><div class="meta">‚Çπ2 / sq.ft ¬∑ Min ‚Çπ999 ¬∑ Max ‚Çπ1999</div></div><div class="price-tag">‚Çπ2</div></label>
          <label class="plan"><div><input type="radio" name="plan" value="2" /> <strong>Naksha + 3D Front Elevation</strong><div class="meta">‚Çπ3 / sq.ft ¬∑ Min ‚Çπ1499 ¬∑ Max ‚Çπ2999</div></div><div class="price-tag">‚Çπ3</div></label>
          <label class="plan"><div><input type="radio" name="plan" value="3" /> <strong>Full Combo: Naksha + 3D + Structural</strong><div class="meta">‚Çπ5 / sq.ft ¬∑ Min ‚Çπ1999 ¬∑ Max ‚Çπ4999</div></div><div class="price-tag">‚Çπ5</div></label>
        </div>

        <div class="offers">
          <div class="sale-badge">Current Offers</div>
          <select id="offersSelect">
            <!-- Options populated by JS -->
          </select>
          <div style="margin-left:auto;color:var(--muted);font-size:13px"></div>
        </div>
        
        <div style="margin-top:16px;color:var(--accent);font-weight:600;font-size:14px;min-height:20px" id="errorMessage"></div>


        <div style="margin-top:10px;display:flex;gap:12px">
          <button class="btn btn-ghost" id="resetBtn">Reset</button>
          <button class="btn btn-primary sparkle" id="calcBtn">Calculate Price</button>
        </div>

      </div>

      <aside class="summary">
        <div class="card">
          <h3>Estimate Summary</h3>
          <div class="muted">Preview of price before you send</div>

          <div style="margin-top:12px">
            <div class="muted">Area (sq.ft)</div>
            <div class="big-price"><span id="areaNum">0</span> <span style="font-size:16px;color:var(--muted);font-weight:500">sq.ft</span></div>

            <div class="muted">Base Price</div>
            <div style="font-size:20px;margin-top:6px;font-weight:600"><span class="price-anim" id="basePrice">‚Çπ0</span></div>

            <div class="muted" style="margin-top:10px">Applied Caps</div>
            <div style="display:flex;gap:16px;margin-top:6px;font-size:14px"><div class="muted">Min: <strong id="minCap">‚Çπ0</strong></div><div class="muted">Max: <strong id="maxCap">‚Çπ0</strong></div></div>

            <div class="muted" style="margin-top:12px">Offer Applied</div>
            <div style="font-weight:700;margin-top:6px" id="offerText">‚Äî</div>

            <div style="margin-top:16px;border-radius:14px;padding:16px;background:linear-gradient(180deg, rgba(255,255,255,0.03), transparent);border:1px solid rgba(255,255,255,0.06)">
              <div class="muted">Final Price</div>
              <div style="font-size:32px;font-weight:900;margin-top:8px"><span id="finalPrice">‚Çπ0</span></div>
            </div>

            <div class="actions">
              <button class="btn btn-primary" id="whatsappBtn">Send via WhatsApp</button>
              <button class="btn btn-ghost" id="downloadBtn">Download Summary</button>
            </div>

            <div style="margin-top:16px;color:var(--muted);font-size:13px">
          ‚ú® This Diwali, make your dream home a reality! Grab our special festive offer now and enjoy amazing savings before it ends! üè†üí´ </div>
        </div>
      </aside>
    </div>

    <footer>UdaanBase ¬∑ Beautiful Homes Within Reach</footer>
  </div>

  <script>
    // ====== CONFIG ======
    const BUSINESS_NUMBER = '917061570522'; 

    const OFFERS = [
      {label: '‚Äî No offer ‚Äî', percent: 0},
      {label: 'Grand Festival Offer ‚Äî 11% off (Diwali Special)', percent: 11}, 
    ];

    const PLANS = {
      1: {name: 'Naksha (2D Floor Plan Only)', rate: 2, min: 999, max:1999},
      2: {name: 'Naksha + 3D Front Elevation', rate: 3, min:1499, max:2999},
      3: {name: 'Full Combo: Naksha + 3D + Structural Design', rate:5, min:1999, max:4999}
    };

    // ====== DOM ======
    const mainContainer = document.getElementById('main-container'); // Get the main container
    const lengthFeet = document.getElementById('lengthFeet');
    const lengthInch = document.getElementById('lengthInch');
    const widthFeet = document.getElementById('widthFeet');
    const widthInch = document.getElementById('widthInch');
    const areaNum = document.getElementById('areaNum');
    const basePriceEl = document.getElementById('basePrice');
    const minCapEl = document.getElementById('minCap');
    const maxCapEl = document.getElementById('maxCap');
    const offerText = document.getElementById('offerText');
    const finalPriceEl = document.getElementById('finalPrice');
    const offersSelect = document.getElementById('offersSelect');
    const calcBtn = document.getElementById('calcBtn');
    const resetBtn = document.getElementById('resetBtn');
    const whatsappBtn = document.getElementById('whatsappBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const clientName = document.getElementById('clientName');
    const clientPhone = document.getElementById('clientPhone');
    const errorMessageEl = document.getElementById('errorMessage');

    // Utility: Display error messages without using alert()
    function displayError(message) {
      errorMessageEl.textContent = message;
      errorMessageEl.style.display = 'block';
      setTimeout(() => {
        errorMessageEl.textContent = '';
        errorMessageEl.style.display = 'none';
      }, 5000);
    }

    // Populate offers select dynamically
    (function populateOffers(){
      offersSelect.innerHTML = '';
      OFFERS.forEach((o, i)=>{
        const opt = document.createElement('option');
        opt.value = o.percent;
        opt.textContent = o.label;
        offersSelect.appendChild(opt);
      });
    })();

    // Utility: compute area (feet + inches)
    function computeArea(){
      const lf = parseFloat(lengthFeet.value) || 0;
      const li = parseFloat(lengthInch.value) || 0;
      const wf = parseFloat(widthFeet.value) || 0;
      const wi = parseFloat(widthInch.value) || 0;
      const length = lf + (li/12);
      const width = wf + (wi/12);
      const area = Math.max(0, length * width); 
      return {length,width,area};
    }

    function getSelectedPlan(){
      const radios = document.querySelectorAll('input[name="plan"]');
      let val = 1;
      radios.forEach(r=>{if(r.checked) val = r.value});
      return PLANS[val];
    }

    function formatINR(v){
      return '‚Çπ'+Number(v).toLocaleString('en-IN',{maximumFractionDigits:0});
    }

    function calculate(){
      const {area} = computeArea();
      const plan = getSelectedPlan();
      const offerPercent = parseFloat(offersSelect.value) || 0;

      let base = Math.round(area * plan.rate);

      // Apply caps
      const minPrice = plan.min;
      const maxPrice = plan.max;
      let capped = base;
      if(capped < minPrice) capped = minPrice;
      if(capped > maxPrice) capped = maxPrice;

      // Apply offer
      const discount = Math.round(capped * (offerPercent/100));
      const final = Math.max(0, capped - discount);

      // update UI
      areaNum.textContent = area.toFixed(2);

      // animate price change
      basePriceEl.classList.remove('bounce');
      setTimeout(()=>{basePriceEl.textContent = formatINR(base); basePriceEl.classList.add('bounce')},10);

      minCapEl.textContent = formatINR(minPrice);
      maxCapEl.textContent = formatINR(maxPrice);
      const selectedOfferLabel = OFFERS.find(o => o.percent === offerPercent)?.label || '‚Äî';
      offerText.textContent = selectedOfferLabel;
      finalPriceEl.textContent = formatINR(final);

      // store current computed values for whatsapp
      window._UdaanState = {area: area.toFixed(2), plan, base, capped, offerPercent, discount, final};
    }

    // Initial load and events
    window.addEventListener('load', () => {
      // 1. Initial Calculation
      calculate();

      // 2. Dynamic Entrance Animation (Main Container)
      setTimeout(() => {
        mainContainer.classList.add('animate-in');
      }, 100); // Small delay after load

      // 3. Start Festive Particles
      const NUM_PARTICLES = 40;
      for (let i = 0; i < NUM_PARTICLES; i++) {
        setTimeout(createLightParticle, i * 250);
      }
    });

    // events
    calcBtn.addEventListener('click', calculate);

    resetBtn.addEventListener('click', ()=>{
      lengthFeet.value = 30; lengthInch.value = 0; widthFeet.value = 20; widthInch.value = 0; clientName.value=''; clientPhone.value=''; offersSelect.value='0'; document.querySelector('input[name="plan"][value="1"]').checked = true; calculate();
      errorMessageEl.textContent = '';
    });

    [lengthFeet,lengthInch,widthFeet,widthInch].forEach(el=>el.addEventListener('input', ()=>{
      const {area} = computeArea();
      areaNum.textContent = area.toFixed(2);
    }));

    // WhatsApp send
    whatsappBtn.addEventListener('click', ()=>{
      calculate(); 
      const st = window._UdaanState || {};
      const name = clientName.value.trim();
      const phone = clientPhone.value.trim();

      if (!name || name.length < 3) {
        displayError('Please enter a valid name (at least 3 characters).');
        clientName.focus();
        return;
      }

      if (!phone || !/^[+\d\s]{8,}$/.test(phone)) {
        displayError('Please enter a valid phone number (min 8 characters).');
        clientPhone.focus();
        return;
      }

      errorMessageEl.textContent = ''; 

      const lines = [];
      lines.push('Hi UdaanBase, I want a design estimate.');
      lines.push('Name: '+name);
      lines.push('Contact: '+phone);
      lines.push('Area (sq.ft): '+st.area);
      lines.push('Selected Plan: '+(st.plan?st.plan.name:'‚Äî'));
      lines.push('Base Price: '+formatINR(st.base || 0));
      lines.push('Applied after caps: '+formatINR(st.capped || 0));
      lines.push('Offer: '+(st.offerPercent?st.offerPercent+'% off':'‚Äî'));
      lines.push('Final Price: '+formatINR(st.final || 0));
      lines.push('\nPlease contact me to proceed.\nThank you!');

      const text = encodeURIComponent(lines.join('\n'));

      const waUrl = 'https://wa.me/'+BUSINESS_NUMBER+'?text='+text;
      window.open(waUrl, '_blank');
    });

    // Download small summary as text file
    downloadBtn.addEventListener('click', ()=>{
      calculate();
      const st = window._UdaanState || {};
      const name = clientName.value || '‚Äî';
      const phone = clientPhone.value || '‚Äî';
      const content = `UdaanBase Estimate\n\nName: ${name}\nContact: ${phone}\nArea (sq.ft): ${st.area}\nPlan: ${st.plan?st.plan.name:'‚Äî'}\nBase: ${formatINR(st.base || 0)}\nAfter Caps: ${formatINR(st.capped || 0)}\nOffer: ${st.offerPercent}%\nFinal: ${formatINR(st.final || 0)}`;
      const blob = new Blob([content], {type:'text/plain'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'udaanbase-estimate.txt'; a.click(); URL.revokeObjectURL(url);
    });

    // ====== FESTIVE ANIMATION (Diwali Look) - REFINED ======

    const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

    function createLightParticle() {
      const bg = document.getElementById('festive-bg');
      if (!bg) return;

      const particle = document.createElement('div');
      particle.className = 'light-particle';

      const size = rand(3, 6);
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;

      particle.style.left = `${rand(0, 100)}vw`;

      const colors = ['#ffc25b', '#ffb46b', '#ff6b6b', '#ffdd99'];
      const primaryColor = colors[rand(0, 1)];
      const secondaryColor = colors[rand(2, 3)];

      particle.style.backgroundColor = primaryColor;
      particle.style.boxShadow = `0 0 10px 5px ${primaryColor}90, 0 0 30px 8px ${secondaryColor}40`;
      
      const duration = rand(10, 16);
      const delay = rand(0, 12000) / 1000;
      particle.style.animationDuration = `${duration}s`;
      particle.style.animationDelay = `${delay}s`;

      bg.appendChild(particle);

      // Use the 'animationend' listener to recycle particles
      const handleAnimationEnd = () => {
        particle.removeEventListener('animationend', handleAnimationEnd);
        particle.remove();
        createLightParticle(); 
      };
      particle.addEventListener('animationend', handleAnimationEnd);
    }
  </script>
</body>
</html>
